(this.webpackJsonpmask_map=this.webpackJsonpmask_map||[]).push([[0],{23:function(e,t,a){},25:function(e,t,a){},27:function(e,t,a){},38:function(e,t,a){"use strict";a.r(t);var r=a(0),c=a(1),n=a.n(c),s=a(13),i=a.n(s),o=(a(23),a(10)),p=a.n(o),d=a(14),u=a(2),l=(a(25),a(26),a(27),a(4)),j=a.n(l),h=(a(28),a(29),a(15)),m=a.n(h),b=a(17);function O(e){return Object(r.jsxs)("div",{className:"search-panel",children:[Object(r.jsx)(f,{dateData:e.dateData,areaData:e.areaData,updateDistrictOption:e.updateDistrictOption,updateSelectPharmacy:e.updateSelectPharmacy}),Object(r.jsx)(y,{selectPharmacy:e.selectPharmacy,myMap:e.myMap})]})}function f(e){var t=e.dateData,a=t.today,c=t.day,n=e.areaData,s=n.cities,i=n.districts,o=n.allDistricts,p=[];for(var d in s)p.push(Object(r.jsx)("option",{value:d,children:d}));return Object(r.jsxs)("div",{className:"searchArea",children:[Object(r.jsxs)("div",{className:"dateTime",children:[Object(r.jsx)("div",{className:"day",children:{0:"\u661f\u671f\u65e5",1:"\u661f\u671f\u4e00",2:"\u661f\u671f\b\u4e8c",3:"\u661f\u671f\u4e09",4:"\u661f\u671f\u56db",5:"\u661f\u671f\u4e94",6:"\u661f\u671f\u516d"}[c]}),Object(r.jsx)("div",{className:"date",children:a})]}),Object(r.jsxs)("form",{className:"areaSelect",children:[Object(r.jsxs)("select",{id:"cities",onChange:function(t){var a=[];for(var c in document.querySelector("#district").disabled=!1,o)o[c].city===t.target.value&&a.push(Object(r.jsx)("option",{value:c,children:c}));e.updateDistrictOption(a)},children:[Object(r.jsx)("option",{value:"",children:"\u8acb\u9078\u64c7\u7e23\u5e02"}),p]}),Object(r.jsxs)("select",{id:"district",onChange:function(t){e.updateSelectPharmacy(t)},disabled:!0,children:[Object(r.jsx)("option",{value:"",children:"\u8acb\u9078\u64c7\u884c\u653f\u5340"}),i]})]})]})}function y(e){var t=e.selectPharmacy;if(t!==[])return Object(r.jsx)("div",{className:"phamracyListArea",children:Object(r.jsx)("ul",{className:"phamracyList",children:t.map((function(t,a){return Object(r.jsx)(x,{pharmacy:t,myMap:e.myMap},a)}))})})}function x(e){var t=e.pharmacy;return Object(r.jsxs)("li",{className:"pharmacy",onClick:function(a){e.myMap.flyTo([t.geometry.coordinates[1],t.geometry.coordinates[0]],18,1)},children:[Object(r.jsx)("h3",{children:t.properties.name}),Object(r.jsxs)("ul",{children:[Object(r.jsx)("li",{children:t.properties.address}),Object(r.jsx)("li",{children:t.properties.phone})]}),Object(r.jsx)("div",{className:"maskAmount",children:Object(r.jsxs)("ul",{children:[Object(r.jsxs)("li",{className:"adult",children:["\u6210\u4eba\u53e3\u7f69 ",t.properties.mask_adult]}),Object(r.jsxs)("li",{className:"child",children:["\u5152\u7ae5\u53e3\u7f69 ",t.properties.mask_child]})]})})]})}var g=function(){var e=Object(c.useState)(null),t=Object(u.a)(e,2),a=t[0],n=t[1],s=Object(c.useState)(!0),i=Object(u.a)(s,2),o=i[0],l=i[1],h=Object(c.useState)([]),f=Object(u.a)(h,2),y=f[0],x=f[1],g=Object(c.useState)(null),v=Object(u.a)(g,2),w=v[0],S=v[1],k=Object(c.useState)(null),D=Object(u.a)(k,2),N=D[0],P=D[1],M=Object(c.useState)([]),C=Object(u.a)(M,2),E=C[0],L=C[1],T=Object(c.useState)(null),A=Object(u.a)(T,2),_=A[0],z=A[1],F=Object(c.useState)(""),I=Object(u.a)(F,2),B=I[0],J=I[1],U=Object(c.useState)(0),Y=Object(u.a)(U,2),q=Y[0],G=Y[1],H=Object(c.useState)({latitude:25.0375603,longitude:121.5618122}),K=Object(u.a)(H,2),Q=K[0];return K[1],Object(c.useEffect)((function(){var e=function(){var e=Object(d.a)(p.a.mark((function e(){var t,a,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://raw.githubusercontent.com/kiang/pharmacies/master/json/points.json");case 2:return t=e.sent,e.next=5,t.json();case 5:a=e.sent,n(a.features),r={},c={},a.features.forEach((function(e){for(var t in e.properties.county in r!==!0&&""!==e.properties.county&&(r[e.properties.county]=[e.geometry.coordinates[1],e.geometry.coordinates[0]]),r)e.properties.county===t&&e.properties.town in c!==!0&&(c[e.properties.town]={city:t,location:[e.geometry.coordinates[1],e.geometry.coordinates[0]]})})),l(!1),S(r),P(c);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();!function(){var e=new Date,t=e.getFullYear(),a=e.getMonth(),r=e.getDate(),c=e.getDay(),n="".concat(t,"/").concat(a+1,"/").concat(r);J(n),G(c)}(),e()}),[]),Object(c.useEffect)((function(){if(a){var e=[Q.latitude,Q.longitude],t=new j.a.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),r=j.a.map("mapid",{center:e,zoom:18,attributionControl:!0,zoomControl:!0});j.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>'}).addTo(r),j.a.marker(e,{icon:t}).addTo(r).bindPopup("Your are here.").openPopup();var c=(new j.a.markerClusterGroup).addTo(r),n=[];a.forEach((function(a){c.addLayer(j.a.marker([a.geometry.coordinates[1],a.geometry.coordinates[0]],{icon:t}).bindPopup("<h3>"+a.properties.name+"</h3><p>\u6210\u4eba\u53e3\u7f69\u6578\u91cf:"+a.properties.mask_adult+"<br/>\b\u5152\u7ae5\u53e3\u7f69\u6578\u91cf:"+a.properties.mask_child+"</p>")),m()(e,[a.geometry.coordinates[1],a.geometry.coordinates[0]])/1e3<1&&n.push(a)})),x(n),r.addLayer(c),z(r)}}),[a,Q]),Object(r.jsxs)("div",{className:"map-container",children:[Object(r.jsx)(O,{dateData:{today:B,day:q},areaData:{cities:w,districts:E,allDistricts:N},selectPharmacy:y,myMap:_,updateDistrictOption:function(e){L(e)},updateSelectPharmacy:function(e){var t=e.target.parentNode.children,r=[],c=[];Array.from(t).forEach((function(e){r.push(e)})),a.forEach((function(e){e.properties.county===r[0].value&&e.properties.town===r[1].value&&c.push(e)})),x(c)}}),Object(r.jsx)("div",{id:"mapid",children:o&&Object(r.jsx)(b.a,{animation:"border"})})]})},v=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,39)).then((function(t){var a=t.getCLS,r=t.getFID,c=t.getFCP,n=t.getLCP,s=t.getTTFB;a(e),r(e),c(e),n(e),s(e)}))};a(37);i.a.render(Object(r.jsx)(n.a.StrictMode,{children:Object(r.jsx)(g,{})}),document.getElementById("root")),v()}},[[38,1,2]]]);
//# sourceMappingURL=main.1cd27b4b.chunk.js.map